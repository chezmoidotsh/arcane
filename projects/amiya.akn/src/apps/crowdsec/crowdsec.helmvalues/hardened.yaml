---
# Security hardening configuration for CrowdSec deployment
# Implements Pod Security Standards and network policies for zero-trust security

# LAPI (Local API) Security Context
lapi:
  securityContext:
    fsGroup: 65534
    runAsGroup: 65534
    runAsNonRoot: true
    runAsUser: 65534
    seccompProfile:
      type: RuntimeDefault

  containerSecurityContext:
    allowPrivilegeEscalation: false
    capabilities:
      drop: [ALL]
    privileged: false
    readOnlyRootFilesystem: true

# Agent Security Context - Requires privileged access for hostPath log reading
agent:
  securityContext:
    fsGroup: 65534
    runAsGroup: 65534
    runAsNonRoot: true
    runAsUser: 65534
    seccompProfile:
      type: RuntimeDefault

  containerSecurityContext:
    allowPrivilegeEscalation: false
    capabilities:
      drop: [ALL]
    privileged: false
    readOnlyRootFilesystem: true
