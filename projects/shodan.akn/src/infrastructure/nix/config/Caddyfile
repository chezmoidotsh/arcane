# ┌───────────────────────────────────────────────────────────────────────────┐
# │ Caddyfile for Shodan AI Stack                                             │
# └───────────────────────────────────────────────────────────────────────────┘

{
  # Disable automatic HTTPS globally
  auto_https off
}

# HTTP Redirect bare IP/hostname to FQDN
http://:1234 {
  redir http://studio.llm.chezmoi.sh:1234{uri}
}

# LM Studio vhost
http://studio.llm.chezmoi.sh:1234 {
  # Proxy to local LM Studio
  reverse_proxy 127.0.0.1:8234

  log {
    output file /Users/shodan/.local/state/log/caddy.studio.access.log
    level INFO
  }

  # Global error handling (inline HTML page)
  import errors.inc
}

# Kokoro TTS vhost
http://kokoro.llm.chezmoi.sh:1234 {
  # Proxy to local Kokoro FastAPI
  reverse_proxy 127.0.0.1:8880

  log {
    output file /Users/shodan/.local/state/log/caddy.kokoro.access.log
    level ERROR
  }

  # Global error handling (inline HTML page)
  import errors.inc
}
