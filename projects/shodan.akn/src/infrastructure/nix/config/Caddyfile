# ┌───────────────────────────────────────────────────────────────────────────┐
# │ Caddyfile for Shodan AI Stack                                             │
# └───────────────────────────────────────────────────────────────────────────┘

{
  # Disable automatic HTTPS globally
  auto_https off
}

# 1234 HTTP Redirect to FQDN
http://:1234 {
  redir http://llm.ai.chezmoi.sh:1234{uri}
}

# LiteLLM vhost
http://llm.ai.chezmoi.sh:1234 {
  # Proxy to local LiteLLM
  reverse_proxy 127.0.0.1:4000

  log {
    output file /Users/shodan/.local/state/log/caddy.llm.access.log
    level INFO
  }

  # Global error handling (inline HTML page)
  import errors.inc
}

# Kokoro TTS vhost
http://kokoro.ai.chezmoi.sh:1234 {
  # Proxy to local Kokoro FastAPI
  reverse_proxy 127.0.0.1:8880

  log {
    output file /Users/shodan/.local/state/log/caddy.kokoro.access.log
    level ERROR
  }

  # Global error handling (inline HTML page)
  import errors.inc
}
