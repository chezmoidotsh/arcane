apiVersion: cilium.io/v2
kind: CiliumNetworkPolicy
metadata:
  annotations:
    policy.networking.k8s.io/description: |
      Allow egress traffic from PostgreSQL database to Kubernetes API server.
      This enables CNPG database pods to communicate with the Kubernetes API for cluster
      management operations, leader election, and status updates.
  name: allow-postgres-to-kubernetes-api
spec:
  endpointSelector:
    matchLabels:
      cnpg.io/cluster: spoolman-database
  egress:
    - toEntities:
        - kube-apiserver
