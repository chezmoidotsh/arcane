---
# CrowdSec AppSec Configuration - Disable Rule 911100 Globally
# Managed by Ansible - DO NOT EDIT MANUALLY
#
# Purpose:
#   Disable CrowdSec OWASP CRS native rule 911100 globally to allow HTTP
#   methods like PUT and DELETE that are commonly used by REST APIs.
#
# Rule 911100 Description:
#   Part of REQUEST-911-METHOD-ENFORCEMENT.conf from OWASP ModSecurity CRS
#
#   This rule validates that the HTTP request method is within the allowed
#   methods list defined in tx.allowed_methods variable. By default, the CRS
#   only allows: GET, HEAD, POST, and OPTIONS.
#
#   Common methods blocked by this rule:
#   - PUT (used for resource updates in REST APIs)
#   - DELETE (used for resource deletion in REST APIs)
#   - PATCH (used for partial resource updates)
#
#   The rule triggers when REQUEST_METHOD is not in the allowed list,
#   resulting in CRITICAL severity alert and request blocking.
#
# Why Disable Globally:
#   Modern web applications and REST APIs extensively use PUT, DELETE, and
#   PATCH methods as part of standard HTTP semantics. Blocking these methods
#   breaks fundamental API operations and makes the WAF incompatible with
#   RESTful architectures.
#
# Scope:
#   This rule is disabled GLOBALLY for ALL hosts behind CrowdSec.
#   All HTTP methods (PUT, DELETE, PATCH, etc.) will be allowed.
#
# Security Consideration:
#   Disabling this rule allows any HTTP method to be used. Ensure that:
#   - Application-level method validation is implemented
#   - Unnecessary methods are disabled at the application/server level
#   - Other WAF rules provide adequate protection against method-based attacks
#
# Alternative Approach:
#   Instead of disabling the rule entirely, you could configure
#   tx.allowed_methods in crs-setup.conf to include additional methods.
#   However, this approach is simpler and more maintainable for environments
#   where method restrictions are handled at the application layer.
#
# Implementation:
#   Uses the on_load hook with RemoveInBandRuleByID to disable the rule
#   globally before any request processing occurs. No host-based filtering
#   is applied.
#
# References:
#   - OWASP CRS Rule 911100
#   - REQUEST-911-METHOD-ENFORCEMENT.conf
#   - CrowdSec AppSec Hooks: https://docs.crowdsec.net/docs/appsec/hooks/
#   - RemoveInBandRuleByID: https://docs.crowdsec.net/docs/appsec/helpers/
#
name: custom/disable-rule-911100
default_remediation: ban
on_load:
  - apply:
      - RemoveInBandRuleByID(911100)
